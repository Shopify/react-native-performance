<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-faq">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.18">
<title data-rh="true">FAQ | React Native Performance</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://shopify.github.io//react-native-performance/docs/faq"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="FAQ | React Native Performance"><meta data-rh="true" name="description" content="Do we need to wrap every screen with ``? Can we somehow auto-inject it for every screen when configuring the react-navigation navigators?"><meta data-rh="true" property="og:description" content="Do we need to wrap every screen with ``? Can we somehow auto-inject it for every screen when configuring the react-navigation navigators?"><link data-rh="true" rel="icon" href="/react-native-performance/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://shopify.github.io//react-native-performance/docs/faq"><link data-rh="true" rel="alternate" href="https://shopify.github.io//react-native-performance/docs/faq" hreflang="en"><link data-rh="true" rel="alternate" href="https://shopify.github.io//react-native-performance/docs/faq" hreflang="x-default"><link rel="stylesheet" href="/react-native-performance/assets/css/styles.f5fd3650.css">
<link rel="preload" href="/react-native-performance/assets/js/runtime~main.ecd6a556.js" as="script">
<link rel="preload" href="/react-native-performance/assets/js/main.174a36af.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/react-native-performance/"><div class="navbar__logo"><img src="/react-native-performance/img/icon.png" alt="React Native Performance" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/react-native-performance/img/icon.png" alt="React Native Performance" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">React Native Performance</b></a><a class="navbar__item navbar__link navbar__link--active" href="/react-native-performance/docs/">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/shopify/react-native-performance" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_S7eR colorModeToggle_vKtC"><button class="clean-btn toggleButton_rCf9 toggleButtonDisabled_Pu9x" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_RiAD"><nav class="menu thin-scrollbar menu_izAj"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/react-native-performance/docs/">Welcome</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/react-native-performance/docs/fundamentals/getting-started">🛠 Fundamentals</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/react-native-performance/docs/guides/react-native-performance-lists-profiler">📚 Guides</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/react-native-performance/docs/resources">🔗 Resources</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/react-native-performance/docs/known-issues">Known issues</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/react-native-performance/docs/faq">FAQ</a></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/react-native-performance/">🏠</a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="item name">FAQ</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>FAQ</h1></header><h3 class="anchor anchorWithStickyNavbar_mojV" id="do-we-need-to-wrap-every-screen-with-performancemeasureview-can-we-somehow-auto-inject-it-for-every-screen-when-configuring-the-react-navigation-navigators">Do we need to wrap every screen with <code>&lt;PerformanceMeasureView&gt;</code>? Can we somehow auto-inject it for every screen when configuring the react-navigation navigators?<a class="hash-link" href="#do-we-need-to-wrap-every-screen-with-performancemeasureview-can-we-somehow-auto-inject-it-for-every-screen-when-configuring-the-react-navigation-navigators" title="Direct link to heading">​</a></h3><p>One maybe tempted to wrap all the screens in their app with the <code>PerformanceMeasureView</code> component when setting up a <code>react-navigation</code> navigator. Something like this:</p><pre class="shiki min-light" style="background-color:#ffffff;color:#24292eff"><div class="language-id">tsx</div><div class="code-container"><code><div class="line"><span style="color:#D32F2F">function</span><span style="color:#24292EFF"> </span><span style="color:#6F42C1">withPerformanceMeasureView</span><span style="color:#24292EFF">&lt;</span><span style="color:#6F42C1">TProps</span><span style="color:#24292EFF">&gt;(</span><span style="color:#6F42C1">Screen</span><span style="color:#D32F2F">:</span><span style="color:#24292EFF"> (props</span><span style="color:#D32F2F">:</span><span style="color:#24292EFF"> </span><span style="color:#6F42C1">TProps</span><span style="color:#24292EFF">) </span><span style="color:#D32F2F">=&gt;</span><span style="color:#24292EFF"> </span><span style="color:#6F42C1">React</span><span style="color:#24292EFF">.</span><span style="color:#6F42C1">ReactElement</span><span style="color:#212121">,</span><span style="color:#24292EFF"> screenName</span><span style="color:#D32F2F">:</span><span style="color:#24292EFF"> </span><span style="color:#1976D2">string</span><span style="color:#24292EFF">) {</span></div><div class="line"><span style="color:#24292EFF">  </span><span style="color:#D32F2F">const</span><span style="color:#24292EFF"> </span><span style="color:#6F42C1">ProfiledScreen</span><span style="color:#24292EFF"> </span><span style="color:#D32F2F">=</span><span style="color:#24292EFF"> (props</span><span style="color:#D32F2F">:</span><span style="color:#24292EFF"> </span><span style="color:#6F42C1">TProps</span><span style="color:#24292EFF">) </span><span style="color:#D32F2F">=&gt;</span><span style="color:#24292EFF"> {</span></div><div class="line"><span style="color:#24292EFF">    </span><span style="color:#D32F2F">return</span><span style="color:#24292EFF"> (</span></div><div class="line"><span style="color:#24292EFF">      &lt;</span><span style="color:#1976D2">PerformanceMeasureView</span><span style="color:#24292EFF"> </span><span style="color:#6F42C1">screenName</span><span style="color:#D32F2F">=</span><span style="color:#24292EFF">{screenName}&gt;</span></div><div class="line"><span style="color:#24292EFF">        &lt;</span><span style="color:#1976D2">Screen</span><span style="color:#24292EFF"> {</span><span style="color:#D32F2F">...</span><span style="color:#24292EFF">props} /&gt;</span></div><div class="line"><span style="color:#24292EFF">      &lt;/</span><span style="color:#1976D2">PerformanceMeasureView</span><span style="color:#24292EFF">&gt;</span></div><div class="line"><span style="color:#24292EFF">    );</span></div><div class="line"><span style="color:#24292EFF">  };</span></div><div class="line"></div><div class="line"><span style="color:#24292EFF">  </span><span style="color:#D32F2F">return</span><span style="color:#24292EFF"> ProfiledScreen;</span></div><div class="line"><span style="color:#24292EFF">}</span></div><div class="line"></div><div class="line"><span style="color:#D32F2F">function</span><span style="color:#24292EFF"> </span><span style="color:#6F42C1">NavigationTree</span><span style="color:#24292EFF">() {</span></div><div class="line"><span style="color:#24292EFF">  </span><span style="color:#D32F2F">return</span><span style="color:#24292EFF"> (</span></div><div class="line"><span style="color:#24292EFF">    &lt;</span><span style="color:#1976D2">NavigationContainer</span><span style="color:#24292EFF">&gt;</span></div><div class="line"><span style="color:#24292EFF">      &lt;</span><span style="color:#1976D2">Stack.Navigator</span><span style="color:#24292EFF">&gt;</span></div><div class="line"><span style="color:#24292EFF">        &lt;</span><span style="color:#1976D2">Stack.Screen</span></div><div class="line"><span style="color:#24292EFF">          </span><span style="color:#6F42C1">name</span><span style="color:#D32F2F">=</span><span style="color:#24292EFF">{</span><span style="color:#1976D2">NavigationKeys</span><span style="color:#24292EFF">.</span><span style="color:#1976D2">SCREEN_1</span><span style="color:#24292EFF">}</span></div><div class="line"><span style="color:#24292EFF">          </span><span style="color:#6F42C1">component</span><span style="color:#D32F2F">=</span><span style="color:#24292EFF">{</span><span style="color:#6F42C1">withPerformanceMeasureView</span><span style="color:#24292EFF">(Screen1</span><span style="color:#212121">,</span><span style="color:#24292EFF"> </span><span style="color:#1976D2">NavigationKeys</span><span style="color:#24292EFF">.</span><span style="color:#1976D2">SCREEN_1</span><span style="color:#24292EFF">)}</span></div><div class="line"><span style="color:#24292EFF">        /&gt;</span></div><div class="line"><span style="color:#24292EFF">        &lt;</span><span style="color:#1976D2">Stack.Screen</span></div><div class="line"><span style="color:#24292EFF">          </span><span style="color:#6F42C1">name</span><span style="color:#D32F2F">=</span><span style="color:#24292EFF">{</span><span style="color:#1976D2">NavigationKeys</span><span style="color:#24292EFF">.</span><span style="color:#1976D2">SCREEN_2</span><span style="color:#24292EFF">}</span></div><div class="line"><span style="color:#24292EFF">          </span><span style="color:#6F42C1">component</span><span style="color:#D32F2F">=</span><span style="color:#24292EFF">{</span><span style="color:#6F42C1">withPerformanceMeasureView</span><span style="color:#24292EFF">(Screen2</span><span style="color:#212121">,</span><span style="color:#24292EFF"> </span><span style="color:#1976D2">NavigationKeys</span><span style="color:#24292EFF">.</span><span style="color:#1976D2">SCREEN_1</span><span style="color:#24292EFF">)}</span></div><div class="line"><span style="color:#24292EFF">        /&gt;</span></div><div class="line"><span style="color:#24292EFF">      &lt;/</span><span style="color:#1976D2">Stack.Navigator</span><span style="color:#24292EFF">&gt;</span></div><div class="line"><span style="color:#24292EFF">    &lt;/</span><span style="color:#1976D2">NavigationContainer</span><span style="color:#24292EFF">&gt;</span></div><div class="line"><span style="color:#24292EFF">  );</span></div><div class="line"><span style="color:#24292EFF">}</span></div></code></div><button type="button" aria-label="Copy code to clipboard" class="copy-button">Copy</button></pre><pre class="shiki nord" style="background-color:#2e3440ff;color:#d8dee9ff"><div class="language-id">tsx</div><div class="code-container"><code><div class="line"><span style="color:#81A1C1">function</span><span style="color:#D8DEE9FF"> </span><span style="color:#88C0D0">withPerformanceMeasureView</span><span style="color:#ECEFF4">&lt;</span><span style="color:#8FBCBB">TProps</span><span style="color:#ECEFF4">&gt;(</span><span style="color:#88C0D0">Screen</span><span style="color:#81A1C1">:</span><span style="color:#D8DEE9FF"> </span><span style="color:#ECEFF4">(</span><span style="color:#D8DEE9">props</span><span style="color:#81A1C1">:</span><span style="color:#D8DEE9FF"> </span><span style="color:#8FBCBB">TProps</span><span style="color:#ECEFF4">)</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">=&gt;</span><span style="color:#D8DEE9FF"> </span><span style="color:#8FBCBB">React</span><span style="color:#ECEFF4">.</span><span style="color:#8FBCBB">ReactElement</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9FF"> </span><span style="color:#D8DEE9">screenName</span><span style="color:#81A1C1">:</span><span style="color:#D8DEE9FF"> </span><span style="color:#8FBCBB">string</span><span style="color:#ECEFF4">)</span><span style="color:#D8DEE9FF"> </span><span style="color:#ECEFF4">{</span></div><div class="line"><span style="color:#D8DEE9FF">  </span><span style="color:#81A1C1">const</span><span style="color:#D8DEE9FF"> </span><span style="color:#88C0D0">ProfiledScreen</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">=</span><span style="color:#D8DEE9FF"> </span><span style="color:#ECEFF4">(</span><span style="color:#D8DEE9">props</span><span style="color:#81A1C1">:</span><span style="color:#D8DEE9FF"> </span><span style="color:#8FBCBB">TProps</span><span style="color:#ECEFF4">)</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">=&gt;</span><span style="color:#D8DEE9FF"> </span><span style="color:#ECEFF4">{</span></div><div class="line"><span style="color:#D8DEE9FF">    </span><span style="color:#81A1C1">return</span><span style="color:#D8DEE9FF"> (</span></div><div class="line"><span style="color:#D8DEE9FF">      </span><span style="color:#81A1C1">&lt;</span><span style="color:#8FBCBB">PerformanceMeasureView</span><span style="color:#D8DEE9FF"> </span><span style="color:#8FBCBB">screenName</span><span style="color:#81A1C1">={</span><span style="color:#D8DEE9">screenName</span><span style="color:#81A1C1">}&gt;</span></div><div class="line"><span style="color:#D8DEE9FF">        </span><span style="color:#81A1C1">&lt;</span><span style="color:#8FBCBB">Screen</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">{...</span><span style="color:#D8DEE9">props</span><span style="color:#81A1C1">}</span><span style="color:#D8DEE9FF"> </span><span style="color:#81A1C1">/&gt;</span></div><div class="line"><span style="color:#D8DEE9FF">      </span><span style="color:#81A1C1">&lt;/</span><span style="color:#8FBCBB">PerformanceMeasureView</span><span style="color:#81A1C1">&gt;</span></div><div class="line"><span style="color:#D8DEE9FF">    )</span><span style="color:#81A1C1">;</span></div><div class="line"><span style="color:#D8DEE9FF">  </span><span style="color:#ECEFF4">}</span><span style="color:#81A1C1">;</span></div><div class="line"></div><div class="line"><span style="color:#D8DEE9FF">  </span><span style="color:#81A1C1">return</span><span style="color:#D8DEE9FF"> </span><span style="color:#D8DEE9">ProfiledScreen</span><span style="color:#81A1C1">;</span></div><div class="line"><span style="color:#ECEFF4">}</span></div><div class="line"></div><div class="line"><span style="color:#81A1C1">function</span><span style="color:#D8DEE9FF"> </span><span style="color:#88C0D0">NavigationTree</span><span style="color:#ECEFF4">()</span><span style="color:#D8DEE9FF"> </span><span style="color:#ECEFF4">{</span></div><div class="line"><span style="color:#D8DEE9FF">  </span><span style="color:#81A1C1">return</span><span style="color:#D8DEE9FF"> (</span></div><div class="line"><span style="color:#D8DEE9FF">    </span><span style="color:#81A1C1">&lt;</span><span style="color:#8FBCBB">NavigationContainer</span><span style="color:#81A1C1">&gt;</span></div><div class="line"><span style="color:#D8DEE9FF">      </span><span style="color:#81A1C1">&lt;</span><span style="color:#8FBCBB">Stack.Navigator</span><span style="color:#81A1C1">&gt;</span></div><div class="line"><span style="color:#D8DEE9FF">        </span><span style="color:#81A1C1">&lt;</span><span style="color:#8FBCBB">Stack.Screen</span></div><div class="line"><span style="color:#D8DEE9FF">          </span><span style="color:#8FBCBB">name</span><span style="color:#81A1C1">={</span><span style="color:#D8DEE9">NavigationKeys</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9">SCREEN_1</span><span style="color:#81A1C1">}</span></div><div class="line"><span style="color:#D8DEE9FF">          </span><span style="color:#8FBCBB">component</span><span style="color:#81A1C1">={</span><span style="color:#88C0D0">withPerformanceMeasureView</span><span style="color:#D8DEE9FF">(</span><span style="color:#D8DEE9">Screen1</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9FF"> </span><span style="color:#D8DEE9">NavigationKeys</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9">SCREEN_1</span><span style="color:#D8DEE9FF">)</span><span style="color:#81A1C1">}</span></div><div class="line"><span style="color:#D8DEE9FF">        </span><span style="color:#81A1C1">/&gt;</span></div><div class="line"><span style="color:#D8DEE9FF">        </span><span style="color:#81A1C1">&lt;</span><span style="color:#8FBCBB">Stack.Screen</span></div><div class="line"><span style="color:#D8DEE9FF">          </span><span style="color:#8FBCBB">name</span><span style="color:#81A1C1">={</span><span style="color:#D8DEE9">NavigationKeys</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9">SCREEN_2</span><span style="color:#81A1C1">}</span></div><div class="line"><span style="color:#D8DEE9FF">          </span><span style="color:#8FBCBB">component</span><span style="color:#81A1C1">={</span><span style="color:#88C0D0">withPerformanceMeasureView</span><span style="color:#D8DEE9FF">(</span><span style="color:#D8DEE9">Screen2</span><span style="color:#ECEFF4">,</span><span style="color:#D8DEE9FF"> </span><span style="color:#D8DEE9">NavigationKeys</span><span style="color:#ECEFF4">.</span><span style="color:#D8DEE9">SCREEN_1</span><span style="color:#D8DEE9FF">)</span><span style="color:#81A1C1">}</span></div><div class="line"><span style="color:#D8DEE9FF">        </span><span style="color:#81A1C1">/&gt;</span></div><div class="line"><span style="color:#D8DEE9FF">      </span><span style="color:#81A1C1">&lt;/</span><span style="color:#8FBCBB">Stack.Navigator</span><span style="color:#81A1C1">&gt;</span></div><div class="line"><span style="color:#D8DEE9FF">    </span><span style="color:#81A1C1">&lt;/</span><span style="color:#8FBCBB">NavigationContainer</span><span style="color:#81A1C1">&gt;</span></div><div class="line"><span style="color:#D8DEE9FF">  )</span><span style="color:#81A1C1">;</span></div><div class="line"><span style="color:#ECEFF4">}</span></div></code></div><button type="button" aria-label="Copy code to clipboard" class="copy-button">Copy</button></pre><p>We advise against doing this. Wrapping the screen component like this will mark it as <code>interactive</code> the moment that component renders <em>anything</em>, including things such as the initial loading indicators. You likely don&#x27;t want this.</p><p>In most scenarios, the subject screen will acquire certain resources, and will render to an &quot;interactive&quot; state after a certain delay. Before the screen is &quot;interactive&quot;, it will render an intermediate &quot;non-interactive&quot; state (aka, a loading screen). <code>PerformanceMeasureView</code> needs this information via the <code>interactive: boolean</code> and <code>renderPassName: string</code> props. See the <a href="/react-native-performance/docs/fundamentals/measuring-render-times#simple-case-at-most-2-render-passes">README</a> for more details. Providing this information will allow the library to compute what you probably really care about: the time taken by a screen to <em>meaningfully</em> render and become interactive. A tradeoff with getting this insight is that this process can probably not be automated in most apps. In most apps, one will need to assess the values of the <code>interactive</code> and <code>renderPassName</code> props on a per-screen basis, based on that screen&#x27;s resource-acquistion logic.</p><p>If, however, you&#x27;re building a &quot;static&quot; app that renders an interactive version of every screen right away without going through incremental render-passes, then you can probably get away with wrapping all the screens like in the above example. So use your best judgement in that scenario.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="do-we-need-to-invoke-the-function-returned-by-the-usestartprofiler-hook-manually-everytime-a-screen-navigation-is-scheduled-can-we-somehow-observe-react-navigation-events-and-automate-this-process">Do we need to invoke the function returned by the useStartProfiler hook manually everytime a screen navigation is scheduled? Can we somehow observe react-navigation events and automate this process?<a class="hash-link" href="#do-we-need-to-invoke-the-function-returned-by-the-usestartprofiler-hook-manually-everytime-a-screen-navigation-is-scheduled-can-we-somehow-observe-react-navigation-events-and-automate-this-process" title="Direct link to heading">​</a></h3><p><code>react-navigation</code> emits certain <a href="https://reactnavigation.org/docs/navigation-events/" target="_blank" rel="noopener noreferrer">events</a> anytime a navigation action is requested. One might wonder if we can somehow observe these events, and automatically notify the profiling library to start performance profiling via the <code>useStartProfiler</code> hook. However, we don&#x27;t want to do this, because doing so will introduce inaccuracies to the output report.</p><p>We want to record the &quot;flow start&quot; event as close as possible to when the user actually requested it from the UI. Ideally, this needs to happen when a given native view (e.g., a button) is pressed (option 1). However, it&#x27;s not possible to do so without providing a custom <code>ProfiledTouchable</code> component that needs to be intrusively introduced throughout an app&#x27;s codebase. Such a custom component would also need to throw away all the benefits (and years of edge-case coverage) put into the stock <code>Touchable</code> components, which feels like re-inventing the wheel.</p><p>The next best option is to record that event when the JS <code>Touchable.onPress</code> callback is invoked (option 2). This is not as accurate as option 1, since it doesn&#x27;t account for the delay caused by propagating the touch event from the native layer to JS layer over the bridge, and it getting consumed over the JS event queue.</p><p>Luckily, <code>Touchable.onPress</code> function receives an object of type <code>GestureResponderEvent</code> as the 0th argument. This object carries a <code>nativeEvent.timestamp: number</code> property. This <code>timestamp</code> is the exact time that we needed via option 1. So if you provide this (optional) <code>GestureResponderEvent</code> object to the library while using option 2, the library can internally effectively switch over to the option 1 calculations, giving us extremely accurate results. Moreover, we can compute the time between the native touch event and the JS <code>onPress</code> invocation to get a sense of how busy the native to JS communication channel is; this is conveyed via the <code>timeToConsumeTouchEvent</code> property in the output <code>RenderPassReports</code>. This information can provide additional debug info in case you&#x27;re noticing high <code>timeToRenderMillis</code> values.</p><p>Observing <code>react-navigation</code> events (option 3) means that we&#x27;re adding a lot more inaccuracies to our calculations. The implementation details of <code>react-navigation</code> add a measurable latency between when we call <code>navigation.navigate</code> (in the <code>Touchable.onPress</code> callbacks in most cases) and when the corresponding react-navigation events are emitted. If you further decouple these two bits of your code bases via another eventing system (e.g., Redux), this latency becomes worse. These latencies are large enough that they make this option a deal breaker for a performance monitoring use-case.</p><p>Moreover, these events don&#x27;t carry the <code>GestureResponderEvent</code> objects, so we cannot even reverse engineer when the native view was actually pressed. We investigated how much work it&#x27;d take to add a patch to <code>react-navigation</code> itself such that the applicable events carry this metadata, however, that was not trivial. For example, the touchable used by the iOS implementation of the drawer navigator (see code <a href="https://github.com/react-navigation/react-navigation/blob/7b353a4aeabe204284b358af204caebe1db093c1/packages/drawer/src/views/TouchableItem.ios.tsx" target="_blank" rel="noopener noreferrer">here</a>) uses the <code>BaseButton</code> component provided by <code>react-native-gesture-handler</code>, which does not send a <code>GestureResponderEvent</code> object via its <code>onPress</code> callback. So implementing this option 3 would require patches into a lot of OSS libraries that we don&#x27;t necessarily control, and the dependency-graph will be extremely brittle. So considering the maintenance and development effort required for getting option 3 implemented correctly, it didn&#x27;t make the cut.</p><p>That being said, it&#x27;s understandable that it&#x27;s error prone (and annoying) to have to make two calls in a <code>Touchable.onPress</code> callback: one to schedule the react-navigation action, and the other to notify rn-performance of that event. To help with that, the companion <code>react-native-performance-navigation</code> library comes with a <a href="/react-native-performance/docs/guides/react-native-performance-navigation/profiling-navigation"><code>useProfiledNavigation</code></a> hook to make this process easier.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="can-we-call-a-function-to-end-the-profiler-timer-in-the-subject-screen-instead-of-wrapping-it-in-component">Can we call a function to end the profiler timer in the subject screen, instead of wrapping it in component?<a class="hash-link" href="#can-we-call-a-function-to-end-the-profiler-timer-in-the-subject-screen-instead-of-wrapping-it-in-component" title="Direct link to heading">​</a></h3><p>No we cannot. Doing so would end the timer when the JS component renders, which is not the same moment in time as when the screen is actually materialized onto the screen via native views. Wrapping the target screen with a <code>&lt;PerformanceMeasureView&gt;</code> allows us to inject an invisible custom view onto the screen (as a sibling of the actual screens&#x27; contents), and wait until it gets rendered natively. We use that as an approximation for when the screen was actually rendered. Note that we&#x27;re still not actually measuring the <em>real</em> views got rendered; but since the injected view is a sibling, this is a fairly good approximation. At least it&#x27;s significantly better than ending the timer when the JS component renders.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/shopify/react-native-performance/edit/main/docs/docs/FAQ.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/react-native-performance/docs/known-issues"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Known issues</div></a></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#do-we-need-to-wrap-every-screen-with-performancemeasureview-can-we-somehow-auto-inject-it-for-every-screen-when-configuring-the-react-navigation-navigators" class="table-of-contents__link toc-highlight">Do we need to wrap every screen with <code>&lt;PerformanceMeasureView&gt;</code>? Can we somehow auto-inject it for every screen when configuring the react-navigation navigators?</a></li><li><a href="#do-we-need-to-invoke-the-function-returned-by-the-usestartprofiler-hook-manually-everytime-a-screen-navigation-is-scheduled-can-we-somehow-observe-react-navigation-events-and-automate-this-process" class="table-of-contents__link toc-highlight">Do we need to invoke the function returned by the useStartProfiler hook manually everytime a screen navigation is scheduled? Can we somehow observe react-navigation events and automate this process?</a></li><li><a href="#can-we-call-a-function-to-end-the-profiler-timer-in-the-subject-screen-instead-of-wrapping-it-in-component" class="table-of-contents__link toc-highlight">Can we call a function to end the profiler timer in the subject screen, instead of wrapping it in component?</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Shopify Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/react-native-performance/assets/js/runtime~main.ecd6a556.js"></script>
<script src="/react-native-performance/assets/js/main.174a36af.js"></script>
</body>
</html>